function refreshlinks(e=null){if($("#link-holder").length<1)return!1;e?e.forEach(function(e){$.ajax({type:"GET",url:$("#link-holder").data("fetch")+"?id="+e,success:function(t){$("#link-"+e).html(t),feather.replace()}})}):$.ajax({type:"GET",url:$("#link-holder").data("refresh"),success:function(e){$("#link-holder").html(e),feather.replace()}})}function triggerShortModal(e){$("#successModal #modal-input").val(e),$("#successModal .modal-qr p").html('<img src="'+e+'/qr" width="150" class="rounded">'),$("#successModal .copy").attr("data-clipboard-text",e),$("#successModal #downloadPNG").attr("href",e+"/qr/download/png/1000"),$("#successModal ul li").filter(":first-child").find("a").attr("href",e+"/qr/download/pdf/1000"),$("#successModal ul li").filter(":nth-child(2)").find("a").attr("href",e+"/qr/download/svg/1000"),$("#successModal #modal-share a").each(function(){$(this).attr("href");$(this).attr("href",$(this).data("href")+encodeURI(e))}),new ClipboardJS("#successModal .copy",{container:document.getElementById("successModal")}).on("success",function(){$("#successModal .copy").text(lang.copy)}),new bootstrap.Modal(document.getElementById("successModal")).show()}$(document).ready(function(){"use strict";$("[data-trigger=server-form]").submit(function(e){e.preventDefault();let t=$(this).attr("action"),a=!0;if($(".form-control").removeClass("is-invalid"),$(this).find("[required]").each(function(){let e=$(this).attr("min")?$(this).attr("min"):3;$(this).val().length<e&&(a=!1,$(this).addClass("is-invalid"),$(this).data("error")&&$.notify({message:$(this).data("error")},{type:"danger",placement:{from:"top",align:"right"}}))}),0==a)return!1;$.ajax({type:"POST",url:t,data:$(this).serialize(),dataType:"json",beforeSend:function(){$("body").append('<div class="preloader"><div class="spinner-border text-primary" role="status"><span class="sr-only">Loading...</span></div></div>')},complete:function(){$(".preloader").remove()},success:function(e){$("input[name=_token]").val(e.token),e.error?$.notify({message:e.message},{type:"danger",placement:{from:"top",align:"right"}}):($.notify({message:e.message},{type:"success",placement:{from:"top",align:"right"}}),void 0!==e.html&&$("body").append(e.html),$(this).find("input,textarea").val(""))}})}),$("[data-trigger=shorten-form]").submit(function(e){e.preventDefault();let t=$(this),a=t.attr("action"),s=new FormData(this),n=$("#metaimage");if($(".form-control").removeClass("is-invalid"),$("#return-error .alert").remove(),"1"==$("input[name=multiple]").val())var i=t.find("#urls");else i=t.find("#url");if(0==i.val().length)return $.notify({message:lang.error},{type:"danger",placement:{from:"top",align:"left"}}),$("#url,#urls").addClass("is-invalid"),!1;if($("#metaimage").length>0&&0!=n.get(0).files.length&&n.get(0).files[0].size>1048576&&0==["image/jpeg","image/jpg"].includes(n.get(0).files[0].type))return $.notify({message:lang.imageerror},{type:"danger",placement:{from:"top",align:"left"}}),!1;let r=t.find("button[type=submit]").text();$.ajax({type:"POST",url:a,data:s,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){t.find("button[type=submit]").html('<div class="preloader"><div class="spinner-border spinner-border-sm text-white" role="status"><span class="sr-only">Loading...</span></div></div>').attr("disabled","disabled")},complete:function(){$(".preloader").remove(),t.find("button[type=submit]").text(r).removeAttr("disabled")},success:function(e){if(e.error)return $.notify({message:e.message},{type:"danger",placement:{from:"top",align:"left"}});let a=e.data.shorturl;if($.notify({message:e.message},{type:"success",placement:{from:"top",align:"left"}}),"1"==$("input[name=multiple]").val())return refreshlinks(),i.val(e.data);$("#output-result").length>0&&($("#output-result #qr-result").html('<span class="p-2 bg-light border border-success d-inline-block rounded"><img src="'+a+'/qr" width="100" class="rounded"></span>'),$("#output-result").removeClass("d-none")),$("#quickshortener").length>0&&$("#quickshortener").hasClass("show")&&$("#quickshortener [data-bs-dismiss=modal]").click(),$("#successModal").length>0?(triggerShortModal(a),refreshlinks(),$("#advancedOptions").removeClass("show"),t.find("input,textarea").val("")):(i.val(a),t.find("[type=submit]").addClass("d-none"),t.find("[type=button]").attr("data-clipboard-text",a).removeClass("d-none"),$("#advancedOptions").removeClass("show"),new ClipboardJS("[data-trigger=shorten-form] [type=button]").on("success",function(){t.find("[type=submit]").removeClass("d-none"),t.find("[type=button]").addClass("d-none"),t.find("input[type!='hidden'],textarea").val("")}))}})}),$("#search").submit(function(e){e.preventDefault();var t=$(this).find("input[type=text]").val(),a=$(this).attr("action");$.ajax({type:"GET",url:a,data:"q="+t,beforeSend:function(){$("#return-ajax").html('<div class="preloader"><div class="spinner-border text-primary" role="status"><span class="sr-only">Loading...</span></div></div>')},complete:function(){$(".preloader").fadeOut("fast",function(){$(this).remove()})},success:function(e){$("#return-ajax").html(e),$("#link-holder").slideUp("fast"),$("#return-ajax").slideDown("fast"),feather.replace()}})}),$(document).on("click","[data-trigger=archiveselected]",function(e){e.preventDefault();let t=[];$("[data-dynamic]").each(function(){$(this).prop("checked")&&t.push($(this).val())}),$.ajax({type:"GET",url:$(this).attr("href"),data:"selected="+JSON.stringify(t),beforeSend:function(){$("#return-ajax").html('<div class="preloader"><div class="spinner-border text-primary" role="status"><span class="sr-only">Loading...</span></div></div>')},complete:function(){$(".preloader").fadeOut("fast",function(){$(this).remove()})},success:function(e){if(e.error)return $.notify({message:e.message},{type:"danger",placement:{from:"bottom",align:"right"}});$.notify({message:e.message},{type:"success",placement:{from:"bottom",align:"right"}}),refreshlinks(t),feather.replace(),void 0!==e.html&&$("body").append(e.html)}})}),$(document).on("change","#payment-form select",function(){var e=$("#total");$.ajax({type:"GET",url:$("#taxrate").data("url"),data:"country="+$(this).val()+"&coupon="+$("#coupon").val(),success:function(t){t.error||($("#taxrate").html(t.html),e.text(t.newprice))}})}),$("#payment-form").submit(function(){$(this).find("button[type=submit]").attr("disabled","disabled").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>')}),$("[data-blockid]").click(function(e){e.preventDefault();let t=$(this),a=$(this).data("blockid"),s=$(this).attr("href");$.ajax({type:"POST",url:window.location.href,data:"action=clicked&blockid="+a}).then(function(){t.attr("target")?window.open(s,"_blank"):window.location=s})}),$(document).on("change","#deeplink\\[enabled\\]",function(){if($(this).prop("checked")){if(0==$("#url").val().length)return $.notify({message:lang.error},{type:"danger",placement:{from:"top",align:"left"}}),$("#url,#urls").addClass("is-invalid"),$(this).prop("checked",!1),!1;$.ajax({type:"GET",url:$("#deeplink\\[enabled\\]").data("server")+"?url="+encodeURIComponent($("#url").val()),success:function(e){if(e.error)return $.notify({message:e.message},{type:"danger",placement:{from:"top",align:"left"}});e.data&&($.notify({message:e.message},{type:"success",placement:{from:"top",align:"left"}}),$("[data-label=device]").before('<div class="deeplinked input-group mb-3"><span class="input-group-text bg-transparent fw-bold">iPhone</span><input class="form-control" type="hidden" name="device[]" value="iPhone"><input class="form-control p-2" type="text" name="dtarget[]" value="'+e.data.ios+'"></div>'),$("[data-label=device]").before('<div class="deeplinked input-group mb-3"><span class="input-group-text bg-transparent fw-bold">iPad</span><input class="form-control" type="hidden" name="device[]" value="iPad"><input class="form-control p-2" type="text" name="dtarget[]" value="'+e.data.ios+'"></div>'),$("[data-label=device]").before('<div class="deeplinked input-group mb-3"><span class="input-group-text bg-transparent fw-bold">Android</span><input class="form-control" type="hidden" name="device[]" value="Android"><input class="form-control p-2" type="text" name="dtarget[]" value="'+e.data.android+'"></div>'),$("#deelinkapple").val(e.data.iosapp),$("#deelinkgoogle").val(e.data.androidapp))}})}else $(".deeplinked").remove()}),$("input[name=bioalias]").on("input",function(){let e=$(this).val(),t=$(this).data("check");e.length>=3?$.ajax({type:"get",url:t,data:"alias="+e,success:function(e){e.available?($("input[name=bioalias]").removeClass("is-invalid").addClass("is-valid"),$(".alias-feedback").removeClass("invalid-feedback").addClass("valid-feedback").text("This alias is available"),$("input[name=bioalias]").next(".btn").removeAttr("disabled","disabled")):($("input[name=bioalias]").removeClass("is-valid").addClass("is-invalid"),$(".alias-feedback").removeClass("valid-feedback").addClass("invalid-feedback").text("This alias is already taken"),$("input[name=bioalias]").next(".btn").attr("disabled","disabled"))}}):($("input[name=bioalias]").removeClass("is-valid is-invalid"),$(".alias-feedback").text(""),$("input[name=bioalias]").next(".btn").removeAttr("disabled","disabled"))})});